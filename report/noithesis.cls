%sheriyuo 魔改版 noithesis

\ProvidesClass{noithesis}
[2023/2/3 1.0 Template for sheriyuo thesis]
\LoadClass[12pt, a4paper]{article}
\usepackage{enumerate}
\usepackage{graphicx,subfigure}
\usepackage{amsmath,amsthm,amsfonts,amssymb,bm}
\usepackage{fontspec}
\usepackage{xeCJK}
\usepackage{longtable,multirow}
\usepackage{color,xcolor}
\usepackage{courier}
\usepackage{ifthen}
\usepackage{calc}
\usepackage{ifpdf}
\usepackage{titling}
\usepackage{listings}
\usepackage{fancyhdr}
\usepackage{algorithm,algorithmic}
\usepackage{booktabs}
\usepackage{ulem}
\usepackage{clrscode3e}
\usepackage{chngcntr}

\lstset{                      
	language=[ANSI]{C},
	backgroundcolor=\color{white},
	basicstyle=\footnotesize\fontspec{Consolas},
	breakatwhitespace=false,
	breaklines,
	captionpos=b,
	commentstyle=\color{olive}\fontspec{Consolas Italic},
	directivestyle=\color{blue},
	extendedchars=false,
	% frame=single,%shadowbox
	framerule=0pt,
	keywordstyle=\color{blue}\fontspec{Consolas Bold},
	morekeywords={*,define,*,include...},
	numbersep=5pt,
	rulesepcolor=\color{red!20!green!20!blue!20},
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	stepnumber=2,
	stringstyle=\color{purple},
	tabsize=4,
	title=\lstname
}

% 若本机编译时缺少字体，可直接在此处修改，本机编译通过即可。
\RequirePackage[fontset=none]{ctex}
\setCJKmainfont[BoldFont=SimHei,ItalicFont=STKaiti]{SimSun}
\setCJKfamilyfont{song}{SimSun}
\setCJKfamilyfont{fs}{STFangsong}
\setCJKfamilyfont{kai}{STKaiti}
\setCJKfamilyfont{hei}{SimHei}

\setlength{\textwidth}{\paperwidth}
\setlength{\textheight}{\paperheight}
\setlength\marginparwidth{0cm}
\setlength\marginparsep{0cm}
\addtolength{\textwidth}{-6.4cm}
\setlength{\oddsidemargin}{3.2cm-1in}
\setlength{\evensidemargin}{\oddsidemargin}
\setlength{\headheight}{20pt}
\setlength{\topskip}{0pt}
\setlength{\skip\footins}{15pt}
\setlength{\topmargin}{2.8cm-1in}
\setlength{\footskip}{1.5cm}
\setlength{\headsep}{0.5cm}
\addtolength{\textheight}{-8.6cm}

\pagestyle{fancy}
\renewcommand{\headheight}{20pt}
\renewcommand{\headrulewidth}{0.2pt}
\renewcommand{\footrulewidth}{0pt}
\lhead{\parbox{\textwidth}{\textsf{\footnotesize \thetitle}}}
\chead{}
\rhead{\parbox{\textwidth}{\raggedleft\textsf{\footnotesize \theauthor}}}
\cfoot{}
\rfoot{\parbox{\textwidth}{\raggedleft\footnotesize \thepage{}}}

\newcommand{\song}{\CJKfamily{song}}
\def\songti{\song}
\newcommand{\fs}{\CJKfamily{fs}}
\def\fangsong{\fs}
\newcommand{\kai}{\CJKfamily{kai}}
\def\kaishu{\kai}
\newcommand{\hei}{\CJKfamily{hei}}
\def\heiti{\hei}

\newlength\noilinespace
\newcommand{\noiChooseFont}[2]{
	\setlength{\noilinespace}{#2*\real{#1}}
	\fontsize{#2}{\noilinespace}\selectfont}
\def\noiDefineFontsize#1#2{
	\expandafter\newcommand\csname #1\endcsname[1][\baselinestretch]{
		\noiChooseFont{##1}{#2}}}
\noiDefineFontsize{chuhao}{42bp}
\noiDefineFontsize{xiaochu}{36bp}
\noiDefineFontsize{yihao}{26bp}
\noiDefineFontsize{xiaoyi}{24bp}
\noiDefineFontsize{erhao}{22bp}
\noiDefineFontsize{xiaoer}{18bp}
\noiDefineFontsize{sanhao}{16bp}
\noiDefineFontsize{xiaosan}{15bp}
\noiDefineFontsize{sihao}{14bp}
\noiDefineFontsize{banxiaosi}{13bp}
\noiDefineFontsize{xiaosi}{12bp}
\noiDefineFontsize{dawu}{11bp}
\noiDefineFontsize{wuhao}{10.5bp}
\noiDefineFontsize{xiaowu}{9bp}
\noiDefineFontsize{liuhao}{7.5bp}
\noiDefineFontsize{xiaoliu}{6.5bp}
\noiDefineFontsize{qihao}{5.5bp}
\noiDefineFontsize{bahao}{5bp}

\renewcommand{\maketitle} {
	\null
	\vskip 2em
	\begin{center}
		{\xiaoer \bf \@title \par} \vskip 1em {\@author\par}
	\end{center}
	\vskip 1em
}

\renewenvironment{abstract}{
	\section*{摘~~要}
	\kai
}{}

\renewcommand\tableofcontents{
	\section*{目~~录}
	\@starttoc{toc}\normalsize}

\renewcommand\section{\@startsection{section}{1}{\z@}
	{-24bp \@plus -1ex \@minus -.2ex}
	{6bp \@plus .2ex}
	{\hei \sihao[1.429]}}
\renewcommand\subsection{\@startsection{subsection}{2}{\z@}
	{-16bp \@plus -1ex \@minus -.2ex}
	{6bp \@plus .2ex}
	{\hei\banxiaosi[1.538]}}
\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}
	{-16bp \@plus -1ex \@minus -.2ex}
	{6bp \@plus .2ex}
	{\hei \xiaosi[1.667]}}